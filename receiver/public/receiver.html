<!doctype html>
<html>

<head>
  <meta charset="utf-8">
  <style type="text/css">
    body {
      margin: 0;
      background-color: gray;
    }

    croquet-deadness-board {
      height: 100vh;
      width: 100vw;
    }
  </style>
  <script src="//www.gstatic.com/cast/sdk/libs/caf_receiver/v3/cast_receiver_framework.js"></script>
  <script type="application/javascript" src="component.js"></script>
</head>

<body>
  <croquet-deadness-board
    model='{"clearedWickets":{"blue":0,"black":0,"yellow":0,"red":0},"deadnessClasses":["blue-on-red","blue-on-black","blue-on-yellow","black-on-blue","black-on-red","black-on-yellow","yellow-on-blue","yellow-on-red","yellow-on-black","red-on-blue","red-on-black","red-on-yellow"]}' />
  <script type="application/javascript">

    // see https://rbf.dev/blog/2023/01/custom-player-cast-receiver-framework/
    const context = cast.framework.CastReceiverContext.getInstance(),
      playerManager = context.getPlayerManager(),
      deadnessElement = document.querySelector('croquet-deadness-board');

    // intercept load messages
    playerManager.setMessageInterceptor(cast.framework.messages.MessageType.LOAD, event => {
      return null;
    });

    // create the options for the receiver. 
    // TODO: do we have to support all basic media here?
    const options = new cast.framework.CastReceiverOptions();
    options.skipPlayersLoad = true;
    options.disableIdleTimeout = true;
    options.supportedCommands =
      cast.framework.messages.Command.ALL_BASIC_MEDIA;
    // Optional, maximize the debug level to diagnose problems.
    context.setLoggerLevel(cast.framework.LoggerLevel.DEBUG);

    // start the cast framework
    context.start(options);

  </script>
</body>

</html>